<!DOCTYPE html>
<html>
<head>
    <title>E-Commerce Platform for YAI-UNDP Program</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            background-color: #f4f4f4;
        }

        /* Navigation Bar */
        .navbar {
            background-color: #004080;
            overflow: hidden;
        }

        .navbar a {
            float: left;
            display: block;
            color: #f2f2f2;
            text-align: center;
            padding: 14px 20px;
            text-decoration: none;
            font-weight: bold;
        }

        .navbar a:hover {
            background-color: #ddd;
            color: black;
        }

        /* Sections */
        .section {
            display: none;
            padding: 20px;
        }

        /* Active Section */
        .active {
            display: block;
        }

        /* Forms and Tables */
        .form-group {
            margin-bottom: 15px;
        }

        input, select, button {
            padding: 8px;
            margin: 5px 0;
            width: 100%;
            box-sizing: border-box;
        }

        button {
            background-color: #28a745;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 4px;
            font-size: 16px;
        }

        button:hover {
            background-color: #218838;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }

        .btn-purchase {
            background-color: #007bff;
            padding: 6px 12px;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 3px;
            font-size: 14px;
        }

        .btn-purchase:hover {
            background-color: #0069d9;
        }

        .btn-confirm {
            background-color: #ffc107;
            padding: 6px 12px;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 3px;
            font-size: 14px;
        }

        .btn-confirm:hover {
            background-color: #e0a800;
        }

        .logout {
            background-color: #dc3545;
            margin-top: 10px;
            padding: 10px;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 4px;
            font-size: 16px;
        }

        .logout:hover {
            background-color: #c82333;
        }

        .success {
            color: green;
            margin-top: 10px;
        }

        .error {
            color: red;
            margin-top: 10px;
        }

        /* Canvas for Chart */
        #chartCanvas {
            background-color: #fff;
            border: 1px solid #ccc;
            margin-top: 20px;
            border-radius: 5px;
        }

        /* Home Section Styling */
        #home {
            background: url('https://images.unsplash.com/photo-1522199755839-a2bacb67c546') no-repeat center center;
            background-size: cover;
            color: white;
            text-align: center;
            padding: 100px 20px;
        }

        #home h1 {
            font-size: 48px;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px #000;
        }

        #home p {
            font-size: 20px;
            text-shadow: 1px 1px 2px #000;
        }

        /* Responsive Design */
        @media screen and (max-width: 768px) {
            .navbar a {
                float: none;
                width: 100%;
                text-align: left;
            }
        }
    </style>
</head>
<body>

    <!-- Navigation Bar -->
    <div class="navbar">
        <a href="#" onclick="showSection('home')">Home</a>
        <a href="https://onuikechibuzo.github.io/yaiundpecommercesolution/purchase%20flow.html" onclick="showSection('purchase-flow')">Purchase Flow</a>
        <a href="#" onclick="showSection('insurance-status')">Online Insurance Status</a>
        <a href="#" onclick="showSection('data-analysis')">Open Source Data Analysis</a>
    </div>

    <!-- Home Section -->
    <div id="home" class="section active">
        <h1>Welcome to Our E-Commerce Platform</h1>
        <p>
            Empowering communities through innovative solutions.<br>
            Partnered with YAI-UNDP to drive sustainable development.
        </p>
        <p>
            <a href="https://onuikechibuzo.github.io/yaiundpecommercesolution/purchase%20flow.html" onclick="showSection('purchase-flow')">Explore Purchase Flow</a> |
            <a href="#insurance-status" onclick="showSection('insurance-status')">Check Insurance Status</a> |
            <a href="#data-analysis" onclick="showSection('data-analysis')">View Data Analysis</a>
        </p>
    </div>

    <!-- Purchase Flow Section -->
    <div id="purchase-flow" class="section">
        <h2>Purchase Flow</h2>
        <div id="purchase-flow-content">
            <!-- Seller Dashboard -->
            <div class="section">
                <h3>Seller Dashboard</h3>
                
                <!-- Add Product Form -->
                <h4>Add New Product</h4>
                <form id="add-product-form">
                    <div class="form-group">
                        <label>Product Name:</label>
                        <input type="text" id="product-name" required>
                    </div>
                    <div class="form-group">
                        <label>Price ($):</label>
                        <input type="number" id="product-price" step="0.01" required>
                    </div>
                    <button type="submit">Add Product</button>
                </form>
                <div id="add-product-message"></div>

                <!-- View Products -->
                <h4>Your Products</h4>
                <table id="seller-products-table">
                    <thead>
                        <tr>
                            <th>Product ID</th>
                            <th>Name</th>
                            <th>Price ($)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Seller's products will be populated here -->
                    </tbody>
                </table>

                <!-- View Released Payments -->
                <h4>Released Payments</h4>
                <table id="seller-payments-table">
                    <thead>
                        <tr>
                            <th>Transaction ID</th>
                            <th>Product Name</th>
                            <th>Amount ($)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Released payments will be populated here -->
                    </tbody>
                </table>
            </div>

            <!-- Buyer Dashboard -->
            <div class="section">
                <h3>Buyer Dashboard</h3>
                
                <!-- Purchase Product -->
                <h4>Purchase a Product</h4>
                <form id="purchase-form">
                    <div class="form-group">
                        <label>Select Product:</label>
                        <select id="purchase-product" required>
                            <!-- Available products will be populated here -->
                        </select>
                    </div>
                    <button type="submit">Purchase</button>
                </form>
                <div id="purchase-message"></div>

                <!-- View Purchases -->
                <h4>Your Purchases</h4>
                <table id="buyer-purchases-table">
                    <thead>
                        <tr>
                            <th>Transaction ID</th>
                            <th>Product Name</th>
                            <th>Amount ($)</th>
                            <th>Status</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Buyer's purchases will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Online Insurance Status Section -->
    <div id="insurance-status" class="section">
        <h2>Online Insurance Status</h2>
        <div id="insurance-status-content">
            <form id="insurance-form">
                <div class="form-group">
                    <label>Enter Policy Number:</label>
                    <input type="text" id="policy-number" required>
                </div>
                <button type="submit">Check Status</button>
            </form>
            <div id="insurance-message"></div>
        </div>
    </div>

    <!-- Open Source Data Analysis Section -->
    <div id="data-analysis" class="section">
        <h2>Open Source Data Analysis</h2>
        <div id="data-analysis-content">
            <h3>Sample Bar Chart</h3>
            <canvas id="chartCanvas" width="600" height="400"></canvas>
        </div>
    </div>

    <script>
        // -----------------------
        // Purchase Flow Functionality
        // -----------------------

        // Data Storage
        let products = [
            {id: 'p1', name: 'Laptop', price: '1000.00', sellerId: 'seller1'},
            {id: 'p2', name: 'Smartphone', price: '500.00', sellerId: 'seller1'},
            {id: 'p3', name: 'Headphones', price: '150.00', sellerId: 'seller1'}
        ];

        let transactions = [
            {id: 't1', productId: 'p1', buyerId: 'buyer1', status: 'Released'},
            {id: 't2', productId: 'p2', buyerId: 'buyer1', status: 'Pending'}
        ];

        // Assuming single seller and buyer for simplicity
        const sellerId = 'seller1';
        const buyerId = 'buyer1';

        // DOM Elements
        const addProductForm = document.getElementById('add-product-form');
        const productNameInput = document.getElementById('product-name');
        const productPriceInput = document.getElementById('product-price');
        const addProductMessage = document.getElementById('add-product-message');

        const sellerProductsTableBody = document.querySelector('#seller-products-table tbody');
        const sellerPaymentsTableBody = document.querySelector('#seller-payments-table tbody');

        const purchaseForm = document.getElementById('purchase-form');
        const purchaseProductSelect = document.getElementById('purchase-product');
        const purchaseMessage = document.getElementById('purchase-message');

        const buyerPurchasesTableBody = document.querySelector('#buyer-purchases-table tbody');

        // Function to generate unique IDs
        function generateId(prefix) {
            return prefix + '-' + Math.random().toString(36).substr(2, 9);
        }

        // Add Product Handler
        addProductForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const name = productNameInput.value.trim();
            const price = parseFloat(productPriceInput.value).toFixed(2);

            if (name === '' || isNaN(price) || price <= 0) {
                addProductMessage.textContent = 'Please enter valid product details.';
                addProductMessage.className = 'error';
                return;
            }

            const product = {
                id: generateId('p'),
                name: name,
                price: price,
                sellerId: sellerId
            };
            products.push(product);
            addProductMessage.textContent = 'Product added successfully!';
            addProductMessage.className = 'success';
            addProductForm.reset();
            renderSellerProducts();
            populateBuyerProducts();
        });

        // Render Seller's Products
        function renderSellerProducts() {
            sellerProductsTableBody.innerHTML = '';
            const sellerProducts = products.filter(p => p.sellerId === sellerId);
            sellerProducts.forEach(product => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${product.id}</td>
                    <td>${product.name}</td>
                    <td>${product.price}</td>
                `;
                sellerProductsTableBody.appendChild(tr);
            });
        }

        // Render Seller's Released Payments
        function renderSellerPayments() {
            sellerPaymentsTableBody.innerHTML = '';
            const releasedTransactions = transactions.filter(t => t.status === 'Released' && products.find(p => p.id === t.productId).sellerId === sellerId);
            releasedTransactions.forEach(txn => {
                const product = products.find(p => p.id === txn.productId);
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${txn.id}</td>
                    <td>${product.name}</td>
                    <td>${product.price}</td>
                `;
                sellerPaymentsTableBody.appendChild(tr);
            });
        }

        // Populate Buyer Products Dropdown
        function populateBuyerProducts() {
            purchaseProductSelect.innerHTML = '';
            products.forEach(product => {
                const option = document.createElement('option');
                option.value = product.id;
                option.textContent = `${product.name} - $${product.price}`;
                purchaseProductSelect.appendChild(option);
            });
        }

        // Purchase Product Handler
        purchaseForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const selectedProductId = purchaseProductSelect.value;
            if (!selectedProductId) {
                purchaseMessage.textContent = 'Please select a product to purchase.';
                purchaseMessage.className = 'error';
                return;
            }

            const transaction = {
                id: generateId('t'),
                productId: selectedProductId,
                buyerId: buyerId,
                status: 'Pending'
            };
            transactions.push(transaction);
            purchaseMessage.textContent = 'Purchase successful! Payment is held until delivery is confirmed.';
            purchaseMessage.className = 'success';
            renderBuyerPurchases();
            renderSellerPayments();
        });

        // Render Buyer's Purchases
        function renderBuyerPurchases() {
            buyerPurchasesTableBody.innerHTML = '';
            const buyerTransactions = transactions.filter(t => t.buyerId === buyerId);
            buyerTransactions.forEach(txn => {
                const product = products.find(p => p.id === txn.productId);
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${txn.id}</td>
                    <td>${product.name}</td>
                    <td>${product.price}</td>
                    <td>${txn.status}</td>
                    <td>
                        ${txn.status === 'Pending' ? `<button class="btn-confirm" onclick="confirmDelivery('${txn.id}')">Confirm Delivery</button>` : ''}
                    </td>
                `;
                buyerPurchasesTableBody.appendChild(tr);
            });
        }

        // Confirm Delivery Handler
        function confirmDelivery(transactionId) {
            const transaction = transactions.find(t => t.id === transactionId && t.buyerId === buyerId);
            if (transaction && transaction.status === 'Pending') {
                transaction.status = 'Released';
                renderBuyerPurchases();
                renderSellerPayments();
                alert('Delivery confirmed! Payment has been released to the seller.');
            }
        }

        // Initial Render with Pre-Populated Data
        renderSellerProducts();
        renderSellerPayments();
        populateBuyerProducts();
        renderBuyerPurchases();

        // -----------------------
        // Online Insurance Status Functionality
        // -----------------------

        // Pre-Populated Insurance Policies
        const insurancePolicies = {
            'INS12345': 'Active',
            'INS67890': 'Expired',
            'INS54321': 'Pending',
            'INS09876': 'Active'
        };

        // DOM Elements
        const insuranceForm = document.getElementById('insurance-form');
        const policyNumberInput = document.getElementById('policy-number');
        const insuranceMessage = document.getElementById('insurance-message');

        // Insurance Status Handler
        insuranceForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const policyNumber = policyNumberInput.value.trim().toUpperCase();
            if (policyNumber === '') {
                insuranceMessage.textContent = 'Please enter a policy number.';
                insuranceMessage.className = 'error';
                return;
            }

            if (insurancePolicies.hasOwnProperty(policyNumber)) {
                insuranceMessage.textContent = `Policy Status: ${insurancePolicies[policyNumber]}`;
                insuranceMessage.className = 'success';
            } else {
                insuranceMessage.textContent = 'Policy not found.';
                insuranceMessage.className = 'error';
            }
        });

        // -----------------------
        // Open Source Data Analysis Functionality
        // -----------------------

        // Sample Data for Analysis
        const sampleData = {
            'January': 120,
            'February': 150,
            'March': 170,
            'April': 80,
            'May': 200,
            'June': 90
        };

        // Function to Draw Bar Chart
        function drawBarChart(data) {
            const canvas = document.getElementById('chartCanvas');
            const ctx = canvas.getContext('2d');
            const chartWidth = canvas.width;
            const chartHeight = canvas.height;
            const padding = 50;
            const barWidth = 40;
            const gap = 20;

            // Clear Canvas
            ctx.clearRect(0, 0, chartWidth, chartHeight);

            // Draw Axes
            ctx.beginPath();
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, chartHeight - padding);
            ctx.lineTo(chartWidth - padding, chartHeight - padding);
            ctx.stroke();

            // Find max value
            const maxValue = Math.max(...Object.values(data)) + 50;

            // Calculate scaling factor
            const scale = (chartHeight - 2 * padding) / maxValue;

            // Draw Bars
            let index = 0;
            for (let month in data) {
                const value = data[month];
                const barHeight = value * scale;
                const x = padding + gap + index * (barWidth + gap);
                const y = chartHeight - padding - barHeight;

                // Draw Bar
                ctx.fillStyle = '#007bff';
                ctx.fillRect(x, y, barWidth, barHeight);

                // Draw Value
                ctx.fillStyle = '#000';
                ctx.textAlign = 'center';
                ctx.fillText(value, x + barWidth / 2, y - 5);

                // Draw Label
                ctx.fillText(month, x + barWidth / 2, chartHeight - padding + 15);

                index++;
            }
        }

        // Draw the chart on page load
        window.onload = function() {
            drawBarChart(sampleData);
        };

        // -----------------------
        // Navigation Functionality
        // -----------------------

        function showSection(sectionId) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => {
                if (section.id === sectionId) {
                    section.classList.add('active');
                } else {
                    section.classList.remove('active');
                }
            });
        }
    </script>
</body>
</html>
